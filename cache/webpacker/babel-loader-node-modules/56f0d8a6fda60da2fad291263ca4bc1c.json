{"ast":null,"code":"var _jsxFileName = \"/Users/Rustam_Mukhamedov/Downloads/kittynews_frontend/app/javascript/packs/posts-index/posts-index.jsx\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React from 'react';\nimport { useQuery, useMutation } from 'react-apollo';\nimport renderComponent from '../utils/renderComponent';\nimport { getAllPostsQuery } from './queries/getAllPosts';\nimport { voteForPostMutation } from './mutations/voteForPost';\nimport { unVoteForPostMutation } from './mutations/unVoteForPost';\n\nfunction PostsIndex() {\n  var _this = this;\n\n  var _useQuery = useQuery(getAllPostsQuery, {\n    fetchPolicy: 'no-cache'\n  }),\n      data = _useQuery.data,\n      loading = _useQuery.loading,\n      error = _useQuery.error;\n\n  var _useMutation = useMutation(voteForPostMutation),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      vote = _useMutation2[0];\n\n  var _useMutation3 = useMutation(unVoteForPostMutation),\n      _useMutation4 = _slicedToArray(_useMutation3, 1),\n      unVote = _useMutation4[0];\n\n  if (loading) return 'Loading...';\n  if (error) return \"Error! \".concat(error.message);\n\n  var handleUpvote = function handleUpvote(post) {\n    if (!data.viewer) {\n      window.location.href += \"users/sign_up\";\n    } else if (post.isVoted) {\n      unVote({\n        variables: {\n          postId: post.id\n        }\n      });\n    } else {\n      vote({\n        variables: {\n          postId: post.id\n        }\n      });\n    }\n  };\n\n  console.log(data);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 5\n    }\n  }, data.postsAll.map(function (post) {\n    return /*#__PURE__*/React.createElement(\"article\", {\n      className: \"post\",\n      key: post.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"/posts/\".concat(post.id),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 13\n      }\n    }, post.title)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"url\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: post.url,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 13\n      }\n    }, post.url)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"tagline\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 11\n      }\n    }, post.tagline), /*#__PURE__*/React.createElement(\"footer\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: handleUpvote.bind(_this, post),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 13\n      }\n    }, post.isVoted ? \"ðŸ”½\" : \"ðŸ”¼\", \" \", post.votesCount, \" \"), /*#__PURE__*/React.createElement(\"button\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 13\n      }\n    }, \"\\uD83D\\uDCAC \", post.commentsCount)));\n  }));\n}\n\nrenderComponent(PostsIndex);","map":{"version":3,"sources":["/Users/Rustam_Mukhamedov/Downloads/kittynews_frontend/app/javascript/packs/posts-index/posts-index.jsx"],"names":["React","useQuery","useMutation","renderComponent","getAllPostsQuery","voteForPostMutation","unVoteForPostMutation","PostsIndex","fetchPolicy","data","loading","error","vote","unVote","message","handleUpvote","post","viewer","window","location","href","isVoted","variables","postId","id","console","log","postsAll","map","title","url","tagline","bind","votesCount","commentsCount"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useQuery, useMutation } from 'react-apollo';\nimport renderComponent from '../utils/renderComponent';\nimport { getAllPostsQuery } from './queries/getAllPosts';\nimport { voteForPostMutation } from './mutations/voteForPost';\nimport { unVoteForPostMutation } from './mutations/unVoteForPost';\n\nfunction PostsIndex() {\n  const { data, loading, error } = useQuery(getAllPostsQuery, { fetchPolicy: 'no-cache'});\n  const [vote] = useMutation(voteForPostMutation);\n  const [unVote] = useMutation(unVoteForPostMutation);\n  \n  if (loading) return 'Loading...';\n  if (error) return `Error! ${error.message}`;\n\n  const handleUpvote = (post) => {\n    if(!data.viewer) {\n      window.location.href += \"users/sign_up\";\n    } else if(post.isVoted) {\n      unVote({ variables: { postId: post.id }})\n    } else {\n      vote({ variables: { postId: post.id }});\n    }\n  }\n\n  console.log(data)\n\n  return (\n    <div className=\"box\">\n      {data.postsAll.map((post) => (\n        <article className=\"post\" key={post.id}>\n          <h2>\n            <a href={`/posts/${post.id}`}>{post.title}</a>\n          </h2>\n          <div className=\"url\">\n            <a href={post.url}>{post.url}</a>\n          </div>\n          <div className=\"tagline\">{post.tagline}</div>\n          <footer>\n            <button onClick={handleUpvote.bind(this, post)}>{post.isVoted ? \"ðŸ”½\" : \"ðŸ”¼\"} {post.votesCount} </button>\n            <button>ðŸ’¬ {post.commentsCount}</button>\n          </footer>\n        </article>\n      ))}\n    </div>\n  );\n}\n\nrenderComponent(PostsIndex);\n"]},"metadata":{},"sourceType":"module"}